---
title: "05 Quiz In Class"
author: "Shane Hauck"
date: "2/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

“All work presented is my own. I have not communicated with or worked with anyone else on this quiz.”
Shane Hauck

Question 1: Consider the following two bar plots using the palmerpenguins data set. The first is a plot of the penguin species while the second is a plot of the average bill length for each species.

```{r}
library(palmerpenguins)
library(tidyverse)


ggplot(data = penguins, aes(x = species)) +
  geom_bar() +
  labs(y = "Count")

ggplot(data = penguins %>% group_by(species) %>%
         summarise(avg_length = mean(bill_length_mm, na.rm = TRUE)),
       aes(x = species, y = avg_length)) +
  geom_col() +
  labs(y = "Average Bill Length")
```

Which of the two graphs is appropriate to construct? Give a one sentence reason.

The first graph is appropriate to construct because when you use a bar plot to show averages you are unable to show the variability of the dataset.



Question 2: Use the Happy Planet Index data set to construct a graph that does not properly show variability in the underlying data. Recall that some variables in this data set are LifeExpectancy, Wellbeing, Footprint, and Region of the world.

```{r}
library(here)
library(maps)
hpi_df <- read_csv(here("data/hpi-tidy.csv"))

plot1_df <- hpi_df %>% group_by(Region) %>%
  mutate(avg_footprint = mean(Footprint))

world_df <- ggplot2::map_data("world")
world_full <- left_join(world_df, plot1_df, by = c("region" = "Country"))

ggplot(world_full, aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill = avg_footprint)) +
  theme_void() +
  coord_map() +
  scale_fill_viridis_b()
```



Question 3:. Fix your graph from the previous question so that it does properly show variability in the underlying data.

```{r}
ggplot(world_full, aes(x = long, y = lat, group = group, label = Region)) +
  geom_polygon(aes(fill = Footprint)) + 
  theme_void() +
  coord_map() +  
  scale_fill_viridis_b()

```

